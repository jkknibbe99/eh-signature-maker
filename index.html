<!DOCTYPE html>
<html style="width: 100%">
    <head>
        <!-- Scale for Mobile -->
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <!-- Bootstrap -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    </head>
    <body style="margin: 0">

        <header class="d-flex flex-wrap justify-content-center align-items-center p-3 m-0 mb-2" style="width: 100%; background: #2F2F2F; color: white;">
            <img src="logo.png" style="height: 100px">
            <h1 class="ms-5">Signature Maker</h1>
        </header>

        <main style="max-width: 1000px; margin: auto;">
            <div class="d-flex flex-wrap">
                <div class="card shadow-sm m-2 flex-fill" style="flex-grow: 1">
                    <div class="card-body">
                        <form id="sigForm">
                            <div class="mb-3">
                                <label for="fullNameInput" class="form-label">Full Name</label>
                                <input name="fullName" class="form-control" id="fullNameInput">
                            </div>
                            <div class="mb-3">
                                <label for="deptInput" class="form-label">Department</label>
                                <input name="dept" type="tel" class="form-control" id="deptInput">
                            </div>
                            <div class="mb-3">
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" role="switch" id="phoneSwitch">
                                    <label class="form-check-label" for="phoneSwitch">User personal phone number</label>
                                </div>
                            </div>
                            <div class="mb-3 visually-hidden" id="phoneField">
                                <label for="phoneInput" class="form-label">Phone Number</label>
                                <input name="phone" type="tel" class="form-control" id="phoneInput">
                            </div>
                        </form>
                    </div>
                </div>
                <div class="card shadow-sm m-2" style="flex-grow: 1">
                    <div class="card-body d-flex flex-column justify-content-center align-items-center">
                        <h2 class="mb-5">Your Signature</h2>
                        <div class="card">
                            <div class="card-body">
                                <div id="signature">
                                    <table cellpadding="0" cellspacing="0" class="table__StyledTable-sc-1avdl6r-0 kAbRZI" style="vertical-align: -webkit-baseline-middle; font-size: medium; font-family: Georgia;">
                                        <tbody>
                                            <tr>
                                                <td>
                                                    <table cellpadding="0" cellspacing="0" class="table__StyledTable-sc-1avdl6r-0 kAbRZI" style="vertical-align: -webkit-baseline-middle; font-size: medium; font-family: Calibri;">
                                                        <tbody>
                                                            <tr>
                                                                <td style="vertical-align: top;">
                                                                    <table cellpadding="0" cellspacing="0" class="table__StyledTable-sc-1avdl6r-0 kAbRZI" style="vertical-align: -webkit-baseline-middle; font-size: medium; font-family: Georgia;">
                                                                        <tbody>
                                                                            <tr>
                                                                                <td class="template1__ImageContainer-sc-nmby7a-0 gjVAKi" style="text-align: center;">
                                                                                    <img decoding="async" src="https://lh3.googleusercontent.com/pw/AJFCJaV9V11TIV_jQ_nOmwGPsBvW-81XR8hef55GLcUw9sj89yrZdr06twKS3kNWdyUiPuz2-2lQAzc6BSNZRQQwxfCtRIqg6wSYX2wkYnyw2wzaP8I7eP1yeVnn2UD643-QhUl-W25G0hC5pD464_jQhS7J=w1917-h1917-s-no?authuser=0" role="presentation" width="100" class="image__StyledImage-sc-hupvqm-0 gYgOut" style="display: block; max-width: 128px;" referrerpolicy="no-referrer" alt="AJFCJaV9V11TIV jQ nOmwGPsBvW 81XR8hef55GLcUw9sj89yrZdr06twKS3kNWdyUiPuz2 2lQAzc6BSNZRQQwxfCtRIqg6wSYX2wkYnyw2wzaP8I7eP1yeVnn2UD643 QhUl W25G0hC5pD464 jQhS7J=w1917 h1917 s no?authuser=0" title="signature - Engelsma Homes">
                                                                                </td>
                                                                            </tr>
                                                                        </tbody>
                                                                    </table>
                                                                </td>
                                                                <td width="5">
                                                                    <div></div>
                                                                </td>
                                                                <td style="padding: 0px; vertical-align: middle;">
                                                                    <p color="#000000" font-size="medium" class="job-title__Container-sc-1hmtp73-0 ifJNJc" style="margin: 0px; color: rgb(0, 0, 0); font-size: 14px; line-height: 20px; font-weight: 600">
                                                                        <span name="fullName">Fname Lname</span>
                                                                    </p>
                                                                    <p color="#000000" font-size="medium" class="job-title__Container-sc-1hmtp73-0 ifJNJc" style="margin: 0px; color: rgb(0, 0, 0); font-size: 14px; line-height: 20px;">
                                                                        <em><span name="dept">Dept</span></em>
                                                                    </p>
                                                                    <p color="#000000" font-size="medium" class="job-title__Container-sc-1hmtp73-0 ifJNJc" style="margin: 0px; color: rgb(0, 0, 0); font-size: 14px; line-height: 20px;">
                                                                        <span>Engelsma Homes, LLC</span>
                                                                    </p>
                                                                    <p color="#000000" font-size="medium" class="job-title__Container-sc-1hmtp73-0 ifJNJc" style="margin: 0px; color: rgb(0, 0, 0); font-size: 14px; line-height: 20px;">
                                                                        <img decoding="async" src="https://lh3.googleusercontent.com/pw/AJFCJaXfg6O4rTtqyIdLWMRTV1oZqiVeU3DYD3Gv5bJgGfm5nta1rul5g-EVO04tvp3jY8d7GAxRXrUtJ9wthHCo2c64zYE7Wwx3zP7c60HG9D4zvWmapZ7Jr7Xo3fSwjhSYk5mp2791cXQVpVVmASyLFevn7Q=w640-h640-s-no?authuser=0" height="10" width="10" alt="P:" referrerpolicy="no-referrer" title="signature - Engelsma Homes">
                                                                        &nbsp;
                                                                        <span name="phone">616 453 3212</span>
                                                                    </p>
                                                                    <p color="#000000" font-size="medium" style="position: relative; margin: 0px; color: rgb(0, 0, 0); font-size: 14px; line-height: 20px;">
                                                                        <img decoding="async" src="https://lh3.googleusercontent.com/pw/AJFCJaUYtYGTdcOmHvvZkwsqONUqalz_mP0_pDmQ9YIvSMUzhd5zbr8qLsT2LN_sFZX7KKBM4u6r7xjmbsUnybN-lUB3hWdqq9-cZ2Cb8J5ApfCvOcY0rY0kqYYsCKhJ7ota-ypKwgY4zDuE5vhXvMlw_UUyTw=w640-h640-s-no?authuser=0" height="10" width="10" alt="W:" referrerpolicy="no-referrer" title="signature - Engelsma Homes">
                                                                        &nbsp;
                                                                        <a href="https://engelsmahomes.com/" color="#000000" style="text-decoration: none; color: rgb(0, 0, 0); font-size: 14px;">
                                                                            <span>engelsmahomes.com</span>
                                                                        </a>
                                                                    </p>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div class="mt-5 mx-auto">
                            <button class="btn btn-primary" id="copyToClipBtn">Copy to clipboard</button>
                            <script>
                                document.getElementById('copyToClipBtn').onclick = () => {
                                    copyHtmlToClipboard(document.getElementById('signature').innerHTML);
                                    document.getElementById('copyToClipBtn').innerHTML = 'Copied!'
                                    setTimeout(() => {
                                        document.getElementById('copyToClipBtn').innerHTML = 'Copy to Clipboard'
                                    }, 5000)
                                }
                            </script>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card shadow-sm m-2">
                <div class="card-body bg-light">
                    <div class="mb-1 ms-3">
                        <h4>Add Signature to Outlook</h4>
                    </div>
                    <ul class="nav nav-tabs">
                        <style>
                            .nav-link:hover {
                                background-color: #f0f2f4;
                            }
                        </style>
                        <li class="nav-item">
                            <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#appAdd" onclick="toggleAppAddDiv(); toggleDesktopAddDiv();">App/Smartphone</button>
                            <script>
                                // Display/hide appAdd div
                                function toggleAppAddDiv() {
                                    const appAdd_div = document.querySelector('#appAdd');
                                    if (appAdd_div.style.display == 'none') {
                                        appAdd_div.style.display = 'block';
                                    } else {
                                        appAdd_div.style.display = 'none';
                                    }
                                }
                            </script>
                        </li>
                        <li class="nav-item">
                            <button class="nav-link" data-bs-toggle="tab" data-bs-target="#desktopAdd" onclick="toggleAppAddDiv(); toggleDesktopAddDiv();">Desktop</button>
                            <script>
                                // Display/hide desktopAdd div
                                function toggleDesktopAddDiv() {
                                    const desktopAdd_div = document.querySelector('#desktopAdd');
                                    if (desktopAdd_div.style.display == 'none') {
                                        desktopAdd_div.style.display = 'block';
                                    } else {
                                        desktopAdd_div.style.display = 'none';
                                    }
                                }
                            </script>
                        </li>
                    </ul>
                    <div id="appAdd" class="card mb-3" style="border-top: none;">
                        <div class="card-body">
                            <h5>Add Signature to Outlook app</h5>
                            <ul>
                                <li>Click on the Copy button <i class="fa-solid fa-copy"></i> above to copy the contents of your new
                                    signature</li>
                                <li>Open your Outlook app</li>
                                <li>Tap on your profile image in the top left corner</li>
                                <li>Tap on the settings gear icon in the bottom left corner</li>
                                <li>scroll down to find and tap 'Signature'</li>
                                <li>Tap on your current signature to edit it</li>
                                <li>Delete all the contents of your current signature, then paste the new one in</li>
                            </ul>
                        </div>
                    </div>
                    <div id="desktopAdd" class="card mb-3" style="border-top: none; display: none;">
                        <div class="card-body">
                            <h5>Add Signature to Outlook for desktop</h5>
                            <ul>
                                <li>Open Outlook</li>
                                <li>Navigate to
                                    <strong>
                                        <ol class="breadcrumb mb-0" style="--bs-breadcrumb-divider: '>';">
                                            <li class="breadcrumb-item">File</li>
                                            <li class="breadcrumb-item">Options</li>
                                        </ol>
                                    </strong>
                                </li>
                                <li>Select <strong>Mail</strong> in the left column</li>
                                <li>In the <strong>Compose messages</strong> section, click the <strong>Signatures...</strong> button
                                </li>
                                <li>Create a new signature and paste your new signature contents into the <strong>Edit
                                        signature</strong>
                                    textbox</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <script>
                // Update signature from inputs
                document.querySelectorAll('#sigForm input').forEach((input) => {
                    // Check if has name
                    if (input.name) {
                        // Phone input
                        if (input.name == 'phone') {
                            input.onkeydown = function(event) {
                                if (['Backspace', 'Home', 'End', 'ArrowLeft', 'ArrowRight'].includes(event.key)) {
                                    // Allowed keys
                                } else if (input.value.length >= 11) {
                                    event.preventDefault();
                                } else if (!/[0-9]/.test(event.key)) {
                                    event.preventDefault();
                                } 
                            }
                        }

                        function inputChange(event) {
                            let value = input.value;
                            // Phone input
                            if (input.name === 'phone') {
                                value = value.replaceAll(' ', '');
                                if (value.length > 10) {
                                    value = `${value.substring(0, 1)} ${value.substring(1, 4)} ${value.substring(4, 7)} ${value.substring(7)}`;
                                } else if (value.length > 9) {
                                    value = `${value.substring(0, 3)} ${value.substring(3, 6)} ${value.substring(6)}`;
                                } else if (value.length > 6) {
                                    value = `${value.substring(0, 3)} ${value.substring(3)}`;
                                }
                            }
                            document.querySelectorAll(`#signature [name=${input.name}]`).forEach((item) => {
                                item.innerHTML = value
                            })
                        }
                        input.onkeyup = inputChange;
                        input.onchange = inputChange;
                    }
                })


                // Phone # switch
                document.querySelector('#phoneSwitch').addEventListener('change', function() {
                    const phoneField = document.querySelector('#phoneField');
                    const phoneInput = phoneField.querySelector('input');
                    if(this.checked) {
                        phoneField.classList.remove('visually-hidden');
                        phoneInput.value = '';
                        phoneInput.dispatchEvent(new Event('change'));
                        // phoneInput.dispatchEvent(new KeyboardEvent('keydown', { key: '0' }));
                    } else {
                        phoneField.classList.add('visually-hidden');
                        phoneInput.value = '616 453 3212';
                        phoneInput.dispatchEvent(new Event('change'));

                        // phoneInput.dispatchEvent(new KeyboardEvent('keydown', { key: '0' }));
                    }
                });


                function copyHtmlToClipboard(html) {
                    // Create container for the HTML
                    // [1]
                    var container = document.createElement('div')
                    container.innerHTML = html

                    // Hide element
                    // [2]
                    container.style.position = 'fixed'
                    container.style.pointerEvents = 'none'
                    container.style.opacity = 0

                    // Detect all style sheets of the page
                    var activeSheets = Array.prototype.slice.call(document.styleSheets)
                        .filter(function (sheet) {
                            return !sheet.disabled
                        })

                    // Mount the container to the DOM to make `contentWindow` available
                    // [3]
                    document.body.appendChild(container)

                    // Copy to clipboard
                    // [4]
                    window.getSelection().removeAllRanges()

                    var range = document.createRange()
                    range.selectNode(container)
                    window.getSelection().addRange(range)

                    // [5.1]
                    document.execCommand('copy')

                    // [5.2]
                    for (var i = 0; i < activeSheets.length; i++) activeSheets[i].disabled = true

                    // [5.3]
                    document.execCommand('copy')

                    // [5.4]
                    for (var i = 0; i < activeSheets.length; i++) activeSheets[i].disabled = false

                    // Remove the container
                    // [6]
                    document.body.removeChild(container)
                }
            </script>
        </main>

        <!-- Bootstrap JS -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
    </body>
</html>
